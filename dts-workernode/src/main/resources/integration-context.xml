<beans:beans xmlns="http://www.springframework.org/schema/integration"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:jms="http://www.springframework.org/schema/integration/jms"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
           http://www.springframework.org/schema/integration
           http://www.springframework.org/schema/integration/spring-integration-1.0.xsd
           http://www.springframework.org/schema/integration/jms
           http://www.springframework.org/schema/integration/jms/spring-integration-jms-1.0.xsd">

  <annotation-config/>

  <!-- Defines a point-to-point channel for receiving DTS job requests. -->
  <channel id="dtsJobRequests"/>
  <channel id="dtsJobEvents"/>

  <!--
    Defines an inbound JMS channel adapter for the DTS job submission queue.
    The inbound adapter means we are receiving from JMS and placing an instance of
    org.springframework.integration.core.Message on the configured channel.
  -->
  <jms:message-driven-channel-adapter
      channel="dtsJobRequests"
      connection-factory="jmsConnectionFactory"
      destination="jmsJobSubmissionQueue"
      message-converter="dtsMessageConverter"
      />

  <!--
    Defines an outbound JMS channel adapter for DTS job events and progress
    notifications.
  -->
  <jms:outbound-channel-adapter
      channel="dtsJobEvents"
      connection-factory="jmsConnectionFactory"
      destination="jmsJobEventQueue"
      />

  <beans:bean id="dtsJobRequestHandler"
              class="org.springframework.batch.integration.launch.JobLaunchingMessageHandler">
    <beans:constructor-arg index="0" ref="dtsJobLauncher"/>
  </beans:bean>

  <service-activator input-channel="dtsJobRequests" ref="dtsJobRequestHandler" method="launch"/>

</beans:beans>
