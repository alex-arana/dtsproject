<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

	<!-- Add automatic WSDL generation support -->
	<bean id="dts"
		class="org.springframework.ws.wsdl.wsdl11.DefaultWsdl11Definition">
		<property name="schema" ref="schema" />
		<property name="portTypeName" value="DataTransferService" />
		<property name="locationUri" value="http://localhost:8080/dts/" />
		<!--
			<property name="targetNamespace"
			value="http://schemas.dataminx.org/dts/2009/05/dts" />
		-->
	</bean>

	<bean id="schema" class="org.springframework.xml.xsd.SimpleXsdSchema">
		<property name="xsd" value="classpath:/minx-dts.xsd" />
	</bean>

	<!-- Register PayloadRootAnnotationMethodEndpointMapping -->

	<bean
		class="org.springframework.ws.server.endpoint.mapping.PayloadRootAnnotationMethodEndpointMapping" />


	<!--
	<bean id="payloadMapping"
		class="org.springframework.ws.server.endpoint.mapping.PayloadRootQNameEndpointMapping">
		<property name="endpointMap">
			<map>
				<entry
					key="{http://schemas.dataminx.org/dts/2009/05/dts}submitJobRequest"
					value-ref="dataTransferEndpoint" />
			</map>
		</property>
	</bean>
	-->

	<!-- Register Endpoint -->
	<bean id="dataTransferEndpoint" class="org.dataminx.dts.ws.DataTransferServiceEndpoint">
		<description>
			This endpoint handles data transfer requests.
		</description>
		<property name="dataTransferService" ref="dataTransferService" />
	</bean>

	<bean id="dataTransferService" class="org.dataminx.dts.service.impl.DataTransferServiceImpl">
		<description>
			This bean is our "business" service.
		</description>
	</bean>

	<!-- Configure XML Marshaller -->
	<bean
		class="org.springframework.ws.server.endpoint.adapter.GenericMarshallingMethodEndpointAdapter">
		<constructor-arg ref="marshaller" />
	</bean>

	<bean id="marshaller" class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
		<property name="classesToBeBound">
			<list>
				<value>
					org.dataminx.schemas.dts._2009._05.dts.SubmitJobRequest
				</value>
				<value>
					org.dataminx.schemas.dts._2009._05.dts.SubmitJobResponse
				</value>
 			    <value>
					org.dataminx.schemas.dts._2009._05.dts.CancelJobRequest
				</value>
				<value>
					org.dataminx.schemas.dts._2009._05.dts.SuspendJobRequest
				</value>
				<value>
					org.dataminx.schemas.dts._2009._05.dts.ResumeJobRequest
				</value>
				<value>
					org.dataminx.schemas.dts._2009._05.dts.GetJobStatusRequest
				</value>
				<value>
					org.dataminx.schemas.dts._2009._05.dts.GetJobStatusResponse
				</value>
			</list>
		</property>

		<!-- <property name="contextPath" value="org.dataminx.schemas.dts._2009._05.dts"/> -->
	</bean>

<!-- uncomment this if JAXB Marshalling will be used on the Client

	<bean id="webServiceTemplate" class="org.springframework.ws.client.core.WebServiceTemplate">
		<property name="messageFactory">
			<bean class="org.springframework.ws.soap.saaj.SaajSoapMessageFactory" />
		</property>
		<property name="defaultUri" value="http://localhost:8080/dts/" />
		<property name="marshaller" ref="marshaller" />
		<property name="unmarshaller" ref="marshaller" />
	</bean>


-->
	<bean id="dataTransferServiceClient" class="org.dataminx.dts.client.DataTransferServiceClientImpl">
		<property name="webServiceTemplate" ref="webServiceTemplate" />
	</bean>


	<bean id="webServiceTemplate" class="org.springframework.ws.client.core.WebServiceTemplate">
		<property name="messageFactory">
			<bean class="org.springframework.ws.soap.saaj.SaajSoapMessageFactory" />
		</property>
		<property name="defaultUri" value="http://localhost:8080/dts/" />
		<property name="messageSender" ref="messageSender" />
	</bean>

	<bean id="messageSender"
		class="org.springframework.ws.transport.http.HttpUrlConnectionMessageSender">
	</bean>


</beans>