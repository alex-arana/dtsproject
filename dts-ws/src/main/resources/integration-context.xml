<beans:beans xmlns="http://www.springframework.org/schema/integration"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:beans="http://www.springframework.org/schema/beans"
    xmlns:jms="http://www.springframework.org/schema/integration/jms"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
           http://www.springframework.org/schema/integration
           http://www.springframework.org/schema/integration/spring-integration-1.0.xsd
           http://www.springframework.org/schema/integration/jms
           http://www.springframework.org/schema/integration/jms/spring-integration-jms-1.0.xsd">

  <annotation-config/>

  <!-- Defines a point-to-point channel for receiving DTS job event updates. -->
  <channel id="dtsJobEvents"/>

  <!--
    Defines an inbound JMS channel adapter for the DTS job event queue.
    The inbound adapter means we are receiving from JMS and placing an instance of
    org.springframework.integration.core.Message on the configured channel.
  -->
  <jms:message-driven-channel-adapter
      channel="dtsJobEvents"
      connection-factory="jmsConnectionFactory"
      destination="jmsJobEventQueue"
      message-converter="dtsWsMessageConverter"
      transaction-manager="jmsTransactionManager"
      />

  <beans:bean id="dtsWsMessageConverter"
              class="org.dataminx.dts.ws.jms.DtsWsMessageConverter">
  </beans:bean>

  <beans:bean id="dtsJobEventUpdateHandler"
              class="org.dataminx.dts.ws.jms.DtsJobEventUpdateHandler">
  </beans:bean>

  <!-- The DTS Job Event Updates Endpoint -->
  <service-activator input-channel="dtsJobEvents"
                     ref="dtsJobEventUpdateHandler"
                     method="handleEvent"/>

  <beans:bean id="dtsWsMessagePayloadTransformer"
              class="org.dataminx.dts.ws.jms.DtsWsMessagePayloadTransformer">
    <beans:constructor-arg index="0" ref="marshaller"/>
  </beans:bean>

</beans:beans>
